# 0. Swap caps lock and ctrl
sudo loadkeys /usr/share/kbd/keymaps/i386/qwerty/emacs2.map.gz
kbdrate -d 30  -r 400

# 1. Partitioning

lsblk
fdisk -l

mkfs.ext3 /dev/sda1
mkfs.ext4 /dev/sda5
mkfs.ext4 /dev/sda6
mkfs.ext4 /dev/sda8

/dev/sda5        46G   12G   32G  27% /
/dev/sda1       227M   36M  179M  17% /boot
/dev/sda6        30G  4.0G   24G  15% /var
/dev/sda8       610G  123G  457G  22% /home

# 2. Mounting

mount /dev/sda5 /mnt
mkdir /mnt/boot /mnt/var /mnt/home

mount /dev/sda1 /mnt/boot
mount /dev/sda6 /mnt/var
mount /dev/sda8 /mnt/home

# 3. install system base
pacstrap /mnt base vim tmux ctags bc dialog wpa_supplicant elinks zsh fish sudo fbterm git hg subversion \
              cvs xclip axel zip unzip unrar rtorrent alsa-utils alsa-oss samba openssh ranger cdrkit \
              net-tools wireless_tools cabextract cmake mutt ntfs-3g fetchmail procmail bitlbee irssi mpd mpc ncmpcpp gdb \
              perl-cpanplus-dist-arch python-pip rfkill

# 4. generate fstab
genfstab -p /mnt >> /mnt/etc/fstab

# 5. change root new env
arch-chroot /mnt
# 5.1 clang + vim
pacman -S clang && vim && cd ~/.vim/bundle/YouCompleteMe && ./install.sh --clang-completer --system-libclang

# get stop sweet home
cd /opt && git clone https://github.com/jkoz/home tait

# 6. create hostname
echo "jkoz_arch_linux" > /etc/hostname

# 7. locale setting
ln -s /usr/share/zoneinfo/Canada/Mountain /etc/localtime

# 8. enable us locale

sed -i 's!#en_US.UTF-8 UTF-8!en_US.UTF-8 UTF-8!' /etc/locale.gen
sed -i 's!#en_US ISO-8859-1!en_US ISO-8859-1!' /etc/locale.gen

locale-gen

# important in order to support unicode charaters in urxvt; give it a test echo "\udf"
localectl set-locale LANG=en_US.UTF-8

# 9. increase kdb rate and persistent keymap (swap caplocks and ctrl)

echo "KEYMAP=\"emacs2\"" > /etc/vconsole.conf
kbdrate -d 30  -r 400

# 10. install grub
pacman -S grub

mkinitcpio -p linux
grub-install /dev/sda
grub-mkconfig -o /boot/grub/grub.cfg

# 11. reboot and set up root passwd
passwd

# 12. enable service network
systemctl list-unit-files
systemctl enable dhcpcd # a workaround method to enable wire connection. In fact, we should use netctl

# 13. add new user
useradd -m -g users -G audio,lp,optical,storage,video,wheel,games,power -d/home/tait -s /usr/bin/zsh tait
usermod -s /usr/bin/zsh root

# 14. enable sudo for wheel groups
sudoedit /etc/sudoers
uncomment %wheel ALL=(ALL) ALL

# 15. install my favorite apps
# required
ctags bc dialog wpa_supplicant elinks zsh sudo fbterm git subversion cvs xclip axel zip unzip unrar rtorrent \
alsa-utils alsa-oss samba openssh ranger cdrkit cabextract cmake mutt ntfs-3g fetchmail procmail \

# network
net-tools rfkill wireless_tools wifi-menu
sudo wifi-menu
sudo netctl enable wlp2s0-tp

# use wpa_supplicant
sudo cat /etc/wpa_supplicant/wpa_supplicant-wlp0s29u1u2.conf
#ctrl_interface=/run/wpa_supplicant
#ctrl_interface_group=wheel
#ap_scan=1
#update_config=1

#network={
    #ssid="tp"
    #scan_ssid=1
    #psk="7804786472"
#}
# start
sudo systemctl start wpa_supplicant@wlp0s29u1u2

# monitor
sudo wpa_cli

# stop wpa
sudo systemctl stop wpa_supplicant@wlp0s29u1u2
sudo wpa_cli terminate


# fonts
pacman -S pcf2bdf xorg-xfontsel xorg-xfontsel xorg-xfd xorg-xlsfonts
yaourt -S gbdfed ttf-mac-fonts

# file manager
pacman -S pcmanfm

# disk
yaourt -S simple-mtpfs sxhkd

xdotool dmenu xorg xorg-server xorg-xinit i3 mplayer xlockmore rxvt-unicode
mupdf feh freetype2  libxft x11vnc xautolock scrot

yaourt -S cabaret compton

ibxcb xcb-util xcb-util-keysyms xcb-util-wm

# yaourt
echo "[archlinuxfr]" >> /etc/pacman.conf
echo "SigLevel = Never" >> /etc/pacman.conf
echo "Server = http://repo.archlinux.fr/$arch" >> /etc/pacman.conf

pacman -S yaourt --needed base-devel

# browser
pacman -S chromium
yaourt -S dropbox dropbox-cli grive chromium-pepper-flash
yaourt -S shrew-vpn-client

# utils
pacman -S xdg-user-dirs
yaourt -S silver-searcher-git

# perl, cpan
cpan Net:DBus

# desktop notification
pacman -S libnotify dunst

# pip
pip install yweather

# status
yaourt -S archey

# dict
yaourt -S stardict-tools
yaourt -S dictconv
yaourt -Ss golden
yaourt -Ss stardict
yaourt -S makedict

# graphic
imagemagick
gimp

# extra
 pacman -S lm_sensors
 pacman -S acpid
 pacman -S gimp
 pacman -S ncitrogen
 pacman -S base-devel abs dmenu
 pacman -S libxft
 pacman -S freetype2

# for install olad8
pacman -S lib32-gtk
pacman -S lib32-alsa-lib
pacman -S lib32-nvidia-utils
pacman -S lib32-libdbus

# 16 generate Downloads, Documents,...
xdg-user-dirs-update

# 17 git experimental apps
git clone https://github.com/baskerville/xtitle
git clone https://github.com/LemonBoy/bar
git clone https://github.com/baskerville/bspwm
git clone https://github.com/jkoz/ldoce5viewer
git clone https://github.com/mrshankly/dmenu2 mrshankly/dmenu2

# DONE!!!!

#################
